<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golfinho V3.0 - Maquette UserForm</title>
    <!-- Tailwind CSS pour le prototypage rapide -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;600;700&display=swap');
        /* Import d'une police Google "Oswald" pour simuler Agency FB si elle n'est pas install√©e sur le PC qui visualise la maquette web */
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600&display=swap');

        :root {
            --bg-app: #F3F4F6;       /* Gris tr√®s clair fond global */
            --bg-sidebar: #FFFFFF;   /* Blanc pur sidebar */
            --bg-card: #FFFFFF;      /* Blanc pur cartes */
            --text-main: #1F2937;    /* Gris tr√®s fonc√© */
            --text-muted: #6B7280;   /* Gris moyen */
            --primary: #0061F2;      /* Bleu Proxiserve/Corporate */
            --border: #E5E7EB;       /* Gris clair bordure */
        }

        body {
            font-family: 'Segoe UI', sans-serif; /* Police native Windows/Excel */
            background-color: #eef2f6;
            height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            user-select: none;
        }

        /* --- CONTENEUR PRINCIPAL (USERFORM) --- */
        .userform-frame {
            width: 1240px;
            height: 750px;
            background-color: var(--bg-app);
            box-shadow: 0 0 0 1px rgba(0,0,0,0.05), 0 20px 50px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: row; /* Sidebar √† gauche, contenu √† droite */
            overflow: hidden;
            /* En VBA: BorderStyle = fmBorderStyleSingle */
        }

        /* --- SIDEBAR (Frame Gauche) --- */
        .sidebar {
            width: 260px;
            background-color: var(--bg-sidebar);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            height: 90px; /* Un peu plus haut pour le style Agency FB */
            display: flex;
            align-items: center;
            padding: 0 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        /* TYPOGRAPHIE TITRE */
        .app-title {
            font-family: 'Agency FB', 'Oswald', sans-serif; /* Priorit√© √† Agency FB */
            font-weight: 700;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        .menu-container {
            flex: 1;
            padding: 1.5rem 0;
            overflow-y: auto;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: var(--text-muted);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.1s;
            border-left: 4px solid transparent;
        }

        .menu-item:hover {
            background-color: #F9FAFB;
            color: var(--primary);
        }

        .menu-item.active {
            background-color: #EFF6FF; /* Bleu tr√®s p√¢le */
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .menu-item i { width: 25px; text-align: center; margin-right: 10px; }

        .sidebar-footer {
            padding: 1.25rem 1.5rem;
            border-top: 1px solid var(--border);
            background-color: #F9FAFB;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        /* --- ZONE CONTENU (MultiPage) --- */
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-app);
            overflow: hidden;
        }

        .top-bar {
            height: 50px; /* COMPACT√â: √âtait 60px */
            background-color: var(--bg-sidebar);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1.5rem; /* COMPACT√â */
        }

        .page-container {
            flex: 1;
            padding: 1.5rem; /* COMPACT√â: √âtait 2rem */
            overflow-y: auto;
        }

        /* --- COMPOSANTS UI (Proxiserve Style) --- */
        
        /* En VBA: Frame avec SpecialEffect = fmSpecialEffectFlat + BorderColor */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 4px; /* VBA: 0px ou image de fond */
            padding: 1rem; /* COMPACT√â: √âtait 1.25rem */
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .card-header {
            font-family: 'Agency FB', 'Oswald', sans-serif;
            text-transform: uppercase;
            font-size: 0.9rem; /* Un peu plus grand car Agency FB est condensed */
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 0.75rem; /* COMPACT√â: √âtait 1rem */
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* En VBA: CommandButton ou Label avec √©v√©nement Click */
        .btn-action {
            background-color: #FFFFFF;
            border: 1px solid var(--border);
            padding: 0.5rem 0.75rem; /* COMPACT√â: √âtait 0.75rem 1rem */
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            transition: all 0.1s;
            position: relative;
        }
        
        /* Simulation de l'effet "Bouton Enfonc√©" de Windows */
        .btn-action:hover { border-color: #BCCCE5; background-color: #F0F5FF; }
        .btn-action:active { background-color: #E0E7FF; transform: translateY(1px); }

        .btn-primary { background-color: #EFF6FF; border-color: #BFDBFE; }
        .btn-danger { background-color: #FEF2F2; border-color: #FECACA; }
        .btn-danger i { color: #DC2626; }
        
        /* Pour les boutons "Secondary" un peu moins visibles */
        .btn-secondary { border-style: dashed; border-color: #D1D5DB; }

        .btn-content { display: flex; flex-direction: column; flex: 1; }
        .btn-title { font-weight: 600; font-size: 0.9rem; color: var(--text-main); }
        .btn-sub { font-size: 0.7rem; color: var(--text-muted); margin-top: 0px; } /* COMPACT√â */

        .status-bar {
            height: 30px;
            background-color: #E5E7EB;
            border-top: 1px solid #D1D5DB;
            display: flex;
            align-items: center;
            padding: 0 1rem;
            font-size: 0.75rem;
            color: #4B5563;
            justify-content: space-between;
        }

        /* Input Style Excel */
        .input-excel {
            background: #fff;
            border: 1px solid #9CA3AF;
            padding: 2px 8px; /* COMPACT√â */
            font-size: 0.9rem;
            width: 100%;
            height: 28px; /* COMPACT√â */
        }
        .input-excel:focus {
            border-color: var(--primary);
            outline: 1px solid var(--primary);
        }
        
        /* Select Style Excel */
        .select-excel {
            background: #fff;
            border: 1px solid #9CA3AF;
            padding: 2px 8px;
            font-size: 0.9rem;
            width: 100%;
            height: 32px;
            cursor: pointer;
        }
        .select-excel:focus {
            border-color: var(--primary);
            outline: 1px solid var(--primary);
        }

        /* Badges */
        .badge {
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
            text-transform: uppercase;
        }
        .badge-blue { background: #EFF6FF; color: #1D4ED8; }
        
        /* Radio Custom pour VBA simulation (OptionButton) */
        .radio-vba {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            cursor: pointer;
        }
        .radio-vba input { margin: 0; }

        /* NOUVEAU: BADGE STATUT */
        .status-badge {
            font-size: 0.6rem;
            padding: 1px 6px;
            border-radius: 4px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border: 1px solid transparent;
            margin-left: 10px;
            transform: translateY(-2px);
            display: inline-block;
        }
        .status-admin { background-color: #FEF2F2; color: #DC2626; border-color: #FECACA; }
        .status-prod { background-color: #F3F4F6; color: #4B5563; border-color: #E5E7EB; }

    </style>
</head>
<body>

    <div class="userform-frame">
        
        <!-- SIDEBAR -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="flex items-center gap-3">
                    <span class="text-3xl text-blue-600">üê¨</span>
                    <div>
                        <div class="app-title text-3xl leading-none text-slate-800">Golfinho</div>
                        <div class="text-[0.65rem] text-slate-400 font-bold tracking-widest uppercase mt-1 pl-0.5">Version 3.0</div>
                    </div>
                </div>
            </div>

            <div class="menu-container">
                <div class="menu-item active" onclick="switchPage('accueil', this)"><i class="fa-solid fa-gauge-high"></i> Dashboard</div>
                <div class="menu-item" onclick="switchPage('patrimoine', this)"><i class="fa-solid fa-building"></i> Patrimoine</div>
                <div class="menu-item" onclick="switchPage('interventions', this)"><i class="fa-solid fa-screwdriver-wrench"></i> Maintenance</div>
                <div class="menu-item" onclick="switchPage('releves', this)"><i class="fa-solid fa-satellite-dish"></i> Relev√©s</div>
                <div class="py-2"><div class="border-t border-gray-200 mx-6"></div></div>
                <div class="menu-item" onclick="switchPage('analyse', this)"><i class="fa-solid fa-chart-pie"></i> Analyses EDI</div>
                <div class="menu-item" onclick="switchPage('rapports', this)"><i class="fa-solid fa-file-invoice-dollar"></i> Rapports</div>
                <div class="menu-item" onclick="switchPage('outils', this)"><i class="fa-solid fa-gear"></i> Param√®tres</div>
            </div>

            <!-- PIED DE PAGE SIDEBAR (SIGNATURE D√âVELOPPEUR) -->
            <div class="sidebar-footer">
                <div class="text-[0.6rem] text-gray-400 font-bold uppercase tracking-widest text-center mb-1">Conception & D√©v.</div>
                
                <div class="flex items-center gap-3 justify-center">
                    <div class="w-8 h-8 rounded-full bg-slate-800 text-white flex items-center justify-center font-bold text-xs shadow-sm">AD</div>
                    <div>
                        <!-- Nom du D√©v Fixe -->
                        <div class="text-sm font-bold text-gray-800 leading-tight">Aur√©lien DA COSTA</div>
                        <div class="text-[0.6rem] text-blue-600 uppercase font-bold tracking-wide">Direction Technique</div>
                    </div>
                </div>
                
                <div class="text-[0.6rem] text-gray-300 mt-1 text-center border-t border-gray-100 pt-2">
                    Tous droits r√©serv√©s ¬© 2026
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="content-area">
            <!-- TOP BAR -->
            <div class="top-bar">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-green-500 shadow-[0_0_5px_rgba(34,197,94,0.6)]"></div>
                    <span class="text-xs font-bold text-gray-600 uppercase tracking-wide">Syst√®me Pr√™t</span>
                </div>
                <div class="flex gap-2">
                    <button class="bg-white border border-gray-300 px-3 py-1 text-xs font-semibold text-gray-600 hover:bg-gray-50 flex items-center gap-2 transition-all"><i class="fa-brands fa-salesforce text-blue-500"></i> CRM</button>
                    <button class="bg-white border border-gray-300 px-3 py-1 text-xs font-semibold text-gray-600 hover:bg-gray-50 flex items-center gap-2 transition-all"><i class="fa-solid fa-book-open text-orange-400"></i> Aide</button>
                    <button class="text-gray-400 hover:text-red-500 px-2 transition-all"><i class="fa-solid fa-power-off"></i></button>
                </div>
            </div>

            <!-- PAGES (MULTIPAGE) -->
            <div class="page-container">
                
                <!-- PAGE 1: DASHBOARD (COMPACT√â) -->
                <div id="page-accueil" class="page-content">
                    <div class="mb-3 flex justify-between items-end">
                        <div>
                            <!-- GREETING USER + STATUT -->
                            <div class="flex items-center">
                                <h2 class="text-2xl font-light text-gray-800">Bonjour, <b id="dashboard-user-name" class="text-blue-600 font-semibold">Aur√©lien D.</b></h2>
                                <!-- Badge de statut ici -->
                                <span id="user-status-badge" class="status-badge status-admin">ADMINISTRATEUR</span>
                            </div>
                            <p class="text-sm text-gray-500 mt-0.5">Actions rapides et suivi des importations.</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-12 gap-4 h-full"> <!-- GAP REDUIT -->
                        <!-- Left Col -->
                        <div class="col-span-8 flex flex-col gap-4"> <!-- GAP REDUIT -->
                            <!-- Card Extraction -->
                            <div class="card border-l-4 border-l-blue-600 shadow-sm">
                                <div class="card-header"><i class="fa-solid fa-bolt text-blue-600"></i> Extractions Rapides</div>
                                
                                <div class="grid grid-cols-2 gap-4 mb-4"> <!-- GAP & MARGE REDUITS -->
                                    <div class="bg-gray-50 p-2.5 rounded border border-gray-100">
                                        <label class="text-[0.65rem] font-bold text-gray-400 uppercase block mb-1 tracking-wider">Recherche par Cit√©</label>
                                        <div class="flex gap-2">
                                            <input type="text" class="input-excel" placeholder="4501299">
                                            <button class="bg-blue-600 text-white px-3 font-bold text-xs hover:bg-blue-700 rounded-sm shadow-sm transition-colors">EXTRAIRE</button>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 p-2.5 rounded border border-gray-100">
                                        <label class="text-[0.65rem] font-bold text-gray-400 uppercase block mb-1 tracking-wider">Recherche par Client</label>
                                        <div class="flex gap-2">
                                            <input type="text" class="input-excel" placeholder="ID Client">
                                            <button class="bg-blue-600 text-white px-3 font-bold text-xs hover:bg-blue-700 rounded-sm shadow-sm transition-colors">EXTRAIRE</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-3 gap-2">
                                    <div class="btn-action">
                                        <i class="fa-solid fa-list-ul text-blue-600 text-lg"></i>
                                        <div class="btn-content"><span class="btn-title">Multi-Cit√©s</span><span class="btn-sub">Extraction DFLGEST</span></div>
                                    </div>
                                    <div class="btn-action">
                                        <i class="fa-solid fa-file-contract text-blue-600 text-lg"></i>
                                        <div class="btn-content"><span class="btn-title">Contrats Agence</span><span class="btn-sub">Listing Clients</span></div>
                                    </div>
                                    <div class="btn-action btn-primary border-blue-200">
                                        <i class="fa-solid fa-database text-blue-700 text-lg"></i>
                                        <div class="btn-content"><span class="btn-title text-blue-900">Base Patrimoine</span><span class="btn-sub text-blue-800/60">Parc Complet</span></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Card Imports -->
                            <div class="card shadow-sm">
                                <div class="card-header"><i class="fa-solid fa-file-import"></i> Imports de Masse</div>
                                <div class="grid grid-cols-3 gap-2"> <!-- GAP REDUIT -->
                                    <div class="btn-action"><i class="fa-solid fa-cloud-arrow-down text-gray-400 text-lg"></i><div class="btn-content"><span class="btn-title">Patrimoine</span><span class="btn-sub">CSV/XLS</span></div></div>
                                    <div class="btn-action"><i class="fa-solid fa-file-shield text-gray-400 text-lg"></i><div class="btn-content"><span class="btn-title">Contrats</span><span class="btn-sub">Mise √† jour</span></div></div>
                                    <div class="btn-action"><i class="fa-solid fa-desktop text-gray-400 text-lg"></i><div class="btn-content"><span class="btn-title">Acc√®s Pro</span><span class="btn-sub">Import</span></div></div>
                                    
                                    <div class="btn-action"><i class="fa-solid fa-bell text-gray-400 text-lg"></i><div class="btn-content"><span class="btn-title">Alarmes</span><span class="btn-sub">Journalier</span></div></div>
                                    <div class="btn-action col-span-2 btn-secondary"><i class="fa-solid fa-satellite-dish text-gray-400 text-lg"></i><div class="btn-content"><span class="btn-title">MBW / GPRS Brut</span><span class="btn-sub">Donn√©es raw</span></div></div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Col -->
                        <div class="col-span-4 flex flex-col gap-4">
                            
                            <!-- CARTE ACTIVIT√â (UPDATED: Split Stats) -->
                            <div class="card bg-blue-600 text-white border-none shadow-md bg-gradient-to-br from-blue-600 to-blue-500 p-4">
                                <div class="flex justify-between items-start mb-3">
                                    <div class="text-[0.65rem] font-bold opacity-75 uppercase tracking-widest">Activit√© Journali√®re</div>
                                    <i class="fa-solid fa-chart-line opacity-50"></i>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4 mb-2">
                                    <!-- Stat 1: Envois -->
                                    <div class="flex flex-col border-r border-blue-400/30 pr-2">
                                        <div class="text-3xl font-bold font-['Agency_FB'] leading-none">12</div>
                                        <div class="text-[0.65rem] opacity-80 uppercase font-medium mt-1 flex items-center gap-1">
                                            <i class="fa-solid fa-cloud-arrow-up text-[0.6rem]"></i> Envois SF
                                        </div>
                                    </div>
                                    <!-- Stat 2: Imports -->
                                    <div class="flex flex-col pl-1">
                                        <div class="text-3xl font-bold font-['Agency_FB'] leading-none">30</div>
                                        <div class="text-[0.65rem] opacity-80 uppercase font-medium mt-1 flex items-center gap-1">
                                            <i class="fa-solid fa-file-import text-[0.6rem]"></i> Imports G.
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Barre de charge globale -->
                                <div class="mt-2">
                                    <div class="flex justify-between text-[0.6rem] opacity-60 mb-1">
                                        <span>Charge</span>
                                        <span>85%</span>
                                    </div>
                                    <div class="h-1 bg-black/20 rounded-full overflow-hidden">
                                        <div class="bg-white/90 h-full w-[85%]"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- LOGS (UPDATED: S√©mantique) -->
                            <div class="card flex-grow shadow-sm">
                                <div class="card-header">Derniers Logs</div>
                                <div class="space-y-3">
                                    
                                    <!-- Log 1: Import -->
                                    <div class="flex items-center gap-3 border-b border-gray-50 pb-2">
                                        <div class="w-8 h-8 rounded bg-green-50 flex items-center justify-center text-green-600 shadow-sm"><i class="fa-solid fa-file-import text-xs"></i></div>
                                        <div>
                                            <div class="text-xs font-bold text-gray-700">Import DFLGEST</div>
                                            <div class="text-[0.65rem] text-gray-400 flex gap-2">
                                                <span>10:42</span>
                                                <span class="text-green-600 font-bold">‚Ä¢ Succ√®s</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Log 2: Extraction (Ex-Scan) -->
                                    <div class="flex items-center gap-3 border-b border-gray-50 pb-2">
                                        <div class="w-8 h-8 rounded bg-blue-50 flex items-center justify-center text-blue-600 shadow-sm"><i class="fa-solid fa-bolt text-xs"></i></div>
                                        <div>
                                            <div class="text-xs font-bold text-gray-700">Extraction Cit√© 45012</div>
                                            <div class="text-[0.65rem] text-gray-400 flex gap-2">
                                                <span>10:15</span>
                                                <span class="text-blue-500 font-bold">‚Ä¢ Consult.</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Log 3: Envoi (Nouveau) -->
                                    <div class="flex items-center gap-3 border-b border-gray-50 pb-2">
                                        <div class="w-8 h-8 rounded bg-purple-50 flex items-center justify-center text-purple-600 shadow-sm"><i class="fa-solid fa-cloud-arrow-up text-xs"></i></div>
                                        <div>
                                            <div class="text-xs font-bold text-gray-700">Envoi MAJPLAN</div>
                                            <div class="text-[0.65rem] text-gray-400 flex gap-2">
                                                <span>09:30</span>
                                                <span class="text-purple-500 font-bold">‚Ä¢ Sync OK</span>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- PAGE 2: PATRIMOINE (UPDATED) -->
                <div id="page-patrimoine" class="page-content hidden">
                    <h2 class="text-2xl font-light text-gray-800 mb-6">Gestion <b class="text-blue-600 font-semibold">Patrimoine</b></h2>
                    
                    <div class="grid grid-cols-12 gap-4">
                        
                        <!-- COLONNE GAUCHE : CR√âATION (Lieux & PDM) -->
                        <div class="col-span-5 flex flex-col gap-4">
                            <!-- 1. LIEUX -->
                            <div class="card">
                                <div class="card-header">Lieux (DFCRAPT)</div>
                                <div class="btn-action mb-2">
                                    <i class="fa-solid fa-plus-circle text-green-600 text-lg"></i>
                                    <div class="btn-content"><span class="btn-title">Cr√©ation Lieux</span><span class="btn-sub">Saisie UserForm</span></div>
                                </div>
                                <div class="flex gap-2">
                                    <div class="btn-action btn-secondary flex-grow mb-0 cursor-pointer p-1">
                                        <div class="btn-content items-center"><i class="fa-solid fa-file-excel text-green-700 mb-1"></i><span class="btn-sub font-bold">Trame</span></div>
                                    </div>
                                    <button class="btn-action border-green-200 bg-green-50 text-green-600 flex-col justify-center px-3 mb-0 hover:bg-green-100 transition-colors">
                                        <i class="fa-solid fa-upload mb-1"></i><span class="text-[0.6rem] font-bold uppercase">Envoyer</span>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- 2. PDM -->
                            <div class="card">
                                <div class="card-header">Points de Mesure (DFCREAPL)</div>
                                <div class="btn-action mb-2">
                                    <i class="fa-solid fa-microchip text-purple-600 text-lg"></i>
                                    <div class="btn-content"><span class="btn-title">Cr√©ation PDM</span><span class="btn-sub">Saisie UserForm</span></div>
                                </div>
                                <div class="flex gap-2">
                                    <div class="btn-action btn-secondary flex-grow mb-0 cursor-pointer p-1">
                                        <div class="btn-content items-center"><i class="fa-solid fa-file-excel text-purple-700 mb-1"></i><span class="btn-sub font-bold">Trame</span></div>
                                    </div>
                                    <button class="btn-action border-purple-200 bg-purple-50 text-purple-600 flex-col justify-center px-3 mb-0 hover:bg-purple-100 transition-colors">
                                        <i class="fa-solid fa-upload mb-1"></i><span class="text-[0.6rem] font-bold uppercase">Envoyer</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- COLONNE DROITE : MISE A JOUR & SYNCHRO (LISTE COMPACTE) -->
                        <div class="col-span-7">
                            <div class="card h-full">
                                <div class="card-header border-b border-gray-100 pb-2 mb-2 flex justify-between">
                                    <span><i class="fa-brands fa-salesforce text-blue-500"></i> Mise √† jour & Synchro</span>
                                    <span class="text-[0.6rem] text-gray-400 font-normal normal-case tracking-normal mt-1">Unitaire / Trame / Envoi</span>
                                </div>
                                
                                <div class="flex flex-col h-full justify-between gap-1">
                                    
                                    <!-- Item 1: HISTO 14 -->
                                    <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded transition-colors group">
                                        <div class="flex flex-col">
                                            <span class="text-sm font-bold text-gray-700 group-hover:text-blue-600 transition-colors">HISTO 14</span>
                                            <span class="text-[0.65rem] text-gray-400 font-medium">Mise √† jour Index</span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-blue-600 hover:border-blue-300 shadow-sm transition-all" title="Saisie Unitaire (Form)"><i class="fa-solid fa-pen-to-square"></i></button>
                                            <div class="w-[1px] bg-gray-200 h-6 self-center"></div>
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-green-600 hover:border-green-300 shadow-sm transition-all" title="Ouvrir Trame Excel"><i class="fa-solid fa-file-excel"></i></button>
                                            <button class="w-8 h-8 rounded bg-blue-50 border border-blue-100 text-blue-600 hover:bg-blue-100 shadow-sm transition-all" title="Envoyer au Serveur"><i class="fa-solid fa-upload"></i></button>
                                        </div>
                                    </div>

                                    <!-- Item 2: RADIATEURS -->
                                    <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded transition-colors group">
                                        <div class="flex flex-col">
                                            <span class="text-sm font-bold text-gray-700 group-hover:text-blue-600 transition-colors">RADIATEURS</span>
                                            <span class="text-[0.65rem] text-gray-400 font-medium">Calibrage & Puissance</span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-blue-600 hover:border-blue-300 shadow-sm transition-all"><i class="fa-solid fa-pen-to-square"></i></button>
                                            <div class="w-[1px] bg-gray-200 h-6 self-center"></div>
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-green-600 hover:border-green-300 shadow-sm transition-all"><i class="fa-solid fa-file-excel"></i></button>
                                            <button class="w-8 h-8 rounded bg-blue-50 border border-blue-100 text-blue-600 hover:bg-blue-100 shadow-sm transition-all"><i class="fa-solid fa-upload"></i></button>
                                        </div>
                                    </div>

                                    <!-- Item 3: COEFF SITU -->
                                    <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded transition-colors group">
                                        <div class="flex flex-col">
                                            <span class="text-sm font-bold text-gray-700 group-hover:text-blue-600 transition-colors">COEFF. SITUATION</span>
                                            <span class="text-[0.65rem] text-gray-400 font-medium">Calculs R√©partiteurs</span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-blue-600 hover:border-blue-300 shadow-sm transition-all"><i class="fa-solid fa-pen-to-square"></i></button>
                                            <div class="w-[1px] bg-gray-200 h-6 self-center"></div>
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-green-600 hover:border-green-300 shadow-sm transition-all"><i class="fa-solid fa-file-excel"></i></button>
                                            <button class="w-8 h-8 rounded bg-blue-50 border border-blue-100 text-blue-600 hover:bg-blue-100 shadow-sm transition-all"><i class="fa-solid fa-upload"></i></button>
                                        </div>
                                    </div>

                                    <!-- Item 4: INFOS LIEUX -->
                                    <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded transition-colors group">
                                        <div class="flex flex-col">
                                            <span class="text-sm font-bold text-gray-700 group-hover:text-blue-600 transition-colors">INFOS LIEUX</span>
                                            <span class="text-[0.65rem] text-gray-400 font-medium">D√©tails Techniques</span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-blue-600 hover:border-blue-300 shadow-sm transition-all"><i class="fa-solid fa-pen-to-square"></i></button>
                                            <div class="w-[1px] bg-gray-200 h-6 self-center"></div>
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-green-600 hover:border-green-300 shadow-sm transition-all"><i class="fa-solid fa-file-excel"></i></button>
                                            <button class="w-8 h-8 rounded bg-blue-50 border border-blue-100 text-blue-600 hover:bg-blue-100 shadow-sm transition-all"><i class="fa-solid fa-upload"></i></button>
                                        </div>
                                    </div>

                                    <!-- Item 5: REF APPAREIL (Le petit nouveau int√©gr√©) -->
                                    <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded transition-colors group border-t border-dashed border-gray-100 mt-1 pt-3">
                                        <div class="flex flex-col">
                                            <span class="text-sm font-bold text-gray-700 group-hover:text-orange-500 transition-colors">R√âF. APPAREILS</span>
                                            <span class="text-[0.65rem] text-gray-400 font-medium">Correction PDM</span>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-orange-500 hover:border-orange-300 shadow-sm transition-all"><i class="fa-solid fa-barcode"></i></button>
                                            <div class="w-[1px] bg-gray-200 h-6 self-center"></div>
                                            <button class="w-8 h-8 rounded bg-white border border-gray-200 text-gray-500 hover:text-green-600 hover:border-green-300 shadow-sm transition-all"><i class="fa-solid fa-file-excel"></i></button>
                                            <button class="w-8 h-8 rounded bg-orange-50 border border-orange-100 text-orange-600 hover:bg-orange-100 shadow-sm transition-all"><i class="fa-solid fa-upload"></i></button>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div id="page-interventions" class="page-content hidden">
                    <h2 class="text-2xl font-light text-gray-800 mb-6">Maintenance & <b class="text-blue-600 font-semibold">Pose</b></h2>
                    <div class="grid grid-cols-2 gap-4">
                        
                        <!-- PLANNING (Conserv√© : Liens externes) -->
                        <div class="card">
                            <div class="card-header">Planning</div>
                            <div class="flex flex-col gap-2">
                                <!-- Bouton 1: Back Office -->
                                <div class="btn-action bg-slate-800 border-none hover:bg-slate-700 shadow-md group mb-0 cursor-pointer">
                                    <i class="fa-solid fa-users-gear text-blue-400 text-lg group-hover:text-white transition-colors"></i>
                                    <div class="btn-content">
                                        <span class="btn-title text-white">Planning Tech.</span>
                                        <span class="btn-sub text-gray-400 group-hover:text-gray-200">Portail Back-Office</span>
                                    </div>
                                </div>
                                <!-- Bouton 2: Console SMAX -->
                                <div class="btn-action border-blue-200 bg-blue-50 hover:bg-blue-100 transition-colors mb-0 cursor-pointer">
                                    <i class="fa-brands fa-salesforce text-blue-600 text-lg"></i>
                                    <div class="btn-content">
                                        <span class="btn-title text-blue-900">Console SMAX</span>
                                        <span class="btn-sub text-blue-700/70">Planification Chantiers</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- MOUVEMENTS (Conserv√© : Saisie Terrain) -->
                        <div class="card">
                            <div class="card-header">Mouvements Produits</div>
                            <!-- Unitaire -->
                            <div class="btn-action mb-2">
                                <i class="fa-solid fa-screwdriver text-slate-600 text-lg"></i>
                                <div class="btn-content"><span class="btn-title">D√©pose / Pose</span><span class="btn-sub">Saisie UserForm</span></div>
                            </div>
                            <!-- Masse & Transfert -->
                            <div class="flex gap-2">
                                <div class="btn-action btn-secondary flex-grow mb-0 cursor-pointer p-1">
                                    <div class="btn-content items-center"><i class="fa-solid fa-file-excel text-slate-600 mb-1"></i><span class="btn-sub font-bold">Trame DFDEPOSE</span></div>
                                </div>
                                <button class="btn-action border-slate-300 bg-slate-100 text-slate-600 flex-col justify-center px-3 mb-0 hover:bg-slate-200 transition-colors" title="Traiter et Envoyer">
                                    <i class="fa-solid fa-upload mb-1"></i>
                                    <span class="text-[0.6rem] font-bold uppercase">Envoyer</span>
                                </button>
                            </div>
                        </div>

                        <!-- GENERATEUR DFLTAB (NOUVEAU : Injections & Stock) -->
                        <div class="card col-span-2">
                            <div class="card-header border-b border-gray-100 pb-2 mb-3 flex justify-between items-center">
                                <span><i class="fa-solid fa-table-list text-blue-500"></i> G√©n√©rateur DFLTAB (Injections)</span>
                                <span class="badge bg-blue-50 text-blue-600 border border-blue-100">Source : DFLGEST</span>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-6 h-full">
                                
                                <!-- ZONE GAUCHE : PARAM√âTRAGE CR (Planning) -->
                                <div class="bg-gray-50/80 rounded-lg border border-gray-200 p-3 flex flex-col justify-between">
                                    <div>
                                        <div class="text-[0.65rem] font-bold text-gray-400 uppercase tracking-wide mb-3 flex items-center gap-2">
                                            <i class="fa-solid fa-filter"></i> Filtres Codes Relev√©s (CR)
                                        </div>
                                        <div class="grid grid-cols-2 gap-y-3 gap-x-2 mb-4 pl-1">
                                            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-600 transition-colors">
                                                <input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 accent-blue-600" checked>
                                                <span class="text-xs font-bold text-gray-700">TOUT CR</span>
                                            </label>
                                            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-600 transition-colors">
                                                <input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 accent-blue-600">
                                                <span class="text-xs font-medium text-gray-600">Code CP</span>
                                            </label>
                                            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-600 transition-colors">
                                                <input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 accent-blue-600">
                                                <span class="text-xs font-medium text-gray-600">Code SC</span>
                                            </label>
                                            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-600 transition-colors">
                                                <input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 accent-blue-600">
                                                <span class="text-xs font-medium text-gray-600">Code NT</span>
                                            </label>
                                        </div>
                                    </div>
                                    <button class="btn-action border-blue-200 bg-white text-blue-700 justify-center hover:bg-blue-50 transition-colors w-full mb-0 shadow-sm">
                                        <i class="fa-solid fa-gears"></i><span class="btn-title text-sm">G√©n√©rer DFLTAB</span>
                                    </button>
                                </div>

                                <!-- ZONE DROITE : IMPORTS STOCK -->
                                <div class="flex flex-col gap-3 justify-center pl-2">
                                    <div class="text-[0.65rem] font-bold text-gray-400 uppercase tracking-wide mb-1 flex items-center gap-2">
                                        <i class="fa-solid fa-boxes-stacked"></i> Mise √† jour du Stock
                                    </div>
                                    
                                    <button class="btn-action justify-between group hover:border-emerald-300 hover:bg-emerald-50/30 transition-all mb-0">
                                        <div class="flex items-center gap-3">
                                            <div class="w-9 h-9 rounded bg-emerald-100 text-emerald-600 flex items-center justify-center shadow-sm"><i class="fa-solid fa-box-open"></i></div>
                                            <div class="flex flex-col text-left">
                                                <span class="btn-title text-gray-800">Import Stock Complet</span>
                                                <span class="btn-sub text-gray-500">Toutes donn√©es (Sans filtre)</span>
                                            </div>
                                        </div>
                                        <i class="fa-solid fa-chevron-right text-gray-300 group-hover:text-emerald-500"></i>
                                    </button>

                                    <button class="btn-action justify-between group hover:border-orange-300 hover:bg-orange-50/30 transition-all mb-0">
                                        <div class="flex items-center gap-3">
                                            <div class="w-9 h-9 rounded bg-orange-100 text-orange-600 flex items-center justify-center shadow-sm"><i class="fa-solid fa-filter"></i></div>
                                            <div class="flex flex-col text-left">
                                                <span class="btn-title text-gray-800">Filtre MTCE / QDC</span>
                                                <span class="btn-sub text-gray-500">Maintenance & Queues Chantiers</span>
                                            </div>
                                        </div>
                                        <i class="fa-solid fa-chevron-right text-gray-300 group-hover:text-orange-500"></i>
                                    </button>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <div id="page-releves" class="page-content hidden">
                    
                    <!-- EN-T√äTE AVEC BOUTON ACC√àS PRO -->
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-light text-gray-800">Relev√©s & <b class="text-blue-600 font-semibold">T√©l√©rel√®ve</b></h2>
                        <!-- Bouton Acc√®s Pro mis en valeur -->
                        <button class="btn-action bg-slate-800 text-white border-none hover:bg-slate-700 shadow-lg px-5 py-2 mb-0 transition-all transform hover:-translate-y-0.5">
                            <i class="fa-solid fa-desktop mr-2 text-blue-400"></i> <span class="font-bold">PORTAIL ACC√àS PRO</span>
                        </button>
                    </div>

                    <div class="grid grid-cols-12 gap-4">
                        
                        <!-- COLONNE GAUCHE : OPERATIONNEL -->
                        <div class="col-span-5 flex flex-col gap-4">
                            
                            <!-- 1. PLANNING SALESFORCE -->
                            <div class="card">
                                <div class="card-header">Planning & Supports</div>
                                <div class="flex flex-col gap-2">
                                    <div class="btn-action border-blue-200 bg-blue-50 hover:bg-blue-100 mb-0 cursor-pointer transition-colors">
                                        <i class="fa-brands fa-salesforce text-blue-600 text-lg"></i>
                                        <div class="btn-content">
                                            <span class="btn-title text-blue-900">Planning Relev√©</span>
                                            <span class="btn-sub text-blue-700/70">Console Salesforce</span>
                                        </div>
                                    </div>
                                    <div class="btn-action border-blue-200 bg-blue-50 hover:bg-blue-100 mb-0 cursor-pointer transition-colors">
                                        <i class="fa-solid fa-print text-blue-600 text-lg"></i>
                                        <div class="btn-content">
                                            <span class="btn-title text-blue-900">Support Manuel</span>
                                            <span class="btn-sub text-blue-700/70">G√©n√©ration DFPO</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 2. MAJPLAN (CALIBRATION) -->
                            <div class="card">
                                <div class="card-header">Calibration (MAJPLAN)</div>
                                <div class="flex gap-2">
                                    <div class="btn-action btn-secondary flex-grow mb-0 cursor-pointer p-1">
                                        <div class="btn-content items-center"><i class="fa-solid fa-file-excel text-slate-600 mb-1"></i><span class="btn-sub font-bold">Fichier Param.</span></div>
                                    </div>
                                    <button class="btn-action border-slate-300 bg-slate-100 text-slate-600 flex-col justify-center px-3 mb-0 hover:bg-slate-200 transition-colors" title="Transfert sur Serveur Jetform">
                                        <i class="fa-solid fa-server mb-1"></i>
                                        <span class="text-[0.6rem] font-bold uppercase">Jetform</span>
                                    </button>
                                </div>
                            </div>

                            <!-- 3. CREATION TESTINSTALL (CONFIGURATEUR) -->
                            <div class="card">
                                <div class="card-header border-b border-gray-100 pb-2 mb-2 flex justify-between items-center">
                                    <span>Cr√©ation Fichier TestInstall</span>
                                    <button class="text-gray-400 hover:text-teal-600 transition-colors" title="Ouvrir dossier"><i class="fa-solid fa-folder-open"></i></button>
                                </div>
                                
                                <div class="flex flex-col gap-3">
                                    <!-- Options (Checkbox) -->
                                    <div class="bg-gray-50 p-2 rounded border border-gray-100 grid grid-cols-2 gap-2">
                                        <label class="flex items-center gap-2 cursor-pointer p-1 hover:bg-white rounded transition-colors">
                                            <input type="checkbox" class="accent-teal-500 w-3 h-3 rounded">
                                            <span class="text-xs font-bold text-gray-600">R4</span>
                                        </label>
                                        <label class="flex items-center gap-2 cursor-pointer p-1 hover:bg-white rounded transition-colors">
                                            <input type="checkbox" class="accent-teal-500 w-3 h-3 rounded">
                                            <span class="text-xs font-bold text-gray-600">OMS</span>
                                        </label>
                                        <label class="flex items-center gap-2 cursor-pointer p-1 hover:bg-white rounded transition-colors">
                                            <input type="checkbox" class="accent-teal-500 w-3 h-3 rounded">
                                            <span class="text-xs font-bold text-gray-600">Apator</span>
                                        </label>
                                        <label class="flex items-center gap-2 cursor-pointer p-1 hover:bg-white rounded transition-colors">
                                            <input type="checkbox" class="accent-teal-500 w-3 h-3 rounded">
                                            <span class="text-xs font-bold text-gray-600">Chauff.</span>
                                        </label>
                                    </div>

                                    <!-- Bouton Cr√©ation -->
                                    <button class="btn-action border-teal-200 bg-teal-50 text-teal-700 justify-center hover:bg-teal-100 transition-colors w-full mb-0 shadow-sm">
                                        <i class="fa-solid fa-file-code mr-2"></i><span class="btn-title text-sm">G√©n√©rer Fichier</span>
                                    </button>
                                </div>
                            </div>

                        </div>

                        <!-- COLONNE DROITE : DATA & ANALYSE -->
                        <div class="col-span-7 flex flex-col gap-4">

                            <!-- 1. WORKFLOWS TELERELVE (Avec Test Blanc) -->
                            <div class="card">
                                <div class="card-header text-purple-600 flex justify-between items-center">
                                    <span>Workflows T√©l√©rel√®ve</span>
                                    <button class="text-purple-300 hover:text-purple-600 transition-colors" title="Ouvrir dossier analyses"><i class="fa-solid fa-folder-open"></i></button>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <!-- MyVoid -->
                                    <div class="btn-action mb-0 cursor-pointer hover:border-purple-300 transition-all">
                                        <i class="fa-solid fa-check-double text-purple-500 text-lg"></i>
                                        <div class="btn-content"><span class="btn-title">Verif. MyVoid</span><span class="btn-sub">Conformit√© Fichier</span></div>
                                    </div>
                                    <!-- Alarmes -->
                                    <div class="btn-action mb-0 cursor-pointer hover:border-orange-300 transition-all">
                                        <i class="fa-solid fa-bell text-orange-500 text-lg"></i>
                                        <div class="btn-content"><span class="btn-title">Analyse Alarmes</span><span class="btn-sub">Diagnostic</span></div>
                                    </div>
                                    
                                    <!-- Test Int√©gration (D√©plac√© ici) -->
                                    <div class="btn-action mb-0 cursor-pointer col-span-2 hover:border-teal-300 bg-teal-50/30 transition-all justify-center">
                                        <i class="fa-solid fa-vial text-teal-500 text-lg mr-3"></i>
                                        <div class="btn-content flex-none"><span class="btn-title text-teal-800">Test Int√©gration (Blanc)</span><span class="btn-sub text-teal-600">Simulation Import Prod</span></div>
                                    </div>

                                    <!-- MBW Tools Sub-Block -->
                                    <div class="col-span-2 flex gap-2 p-2 bg-purple-50 rounded border border-purple-100 items-center mt-1">
                                        <div class="flex flex-col w-20 pl-1">
                                            <span class="text-xs font-bold text-purple-700">MBW</span>
                                            <span class="text-[0.6rem] text-purple-400 font-bold uppercase">Tools</span>
                                        </div>
                                        <button class="btn-action border-white bg-white text-purple-600 flex-grow mb-0 justify-center h-9 shadow-sm hover:text-purple-800 transition-colors">
                                            <i class="fa-solid fa-shuffle mr-2"></i> Fusionner
                                        </button>
                                        <button class="btn-action border-white bg-white text-purple-600 flex-grow mb-0 justify-center h-9 shadow-sm hover:text-purple-800 transition-colors">
                                            <i class="fa-solid fa-magnifying-glass-chart mr-2"></i> Analyser
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 2. ANALYSE PATRIMOINE (FILTRES COMPLETS) -->
                            <div class="card flex-grow">
                                <div class="card-header border-b border-gray-100 pb-2 mb-3 flex justify-between items-center">
                                    <span><i class="fa-solid fa-chart-pie text-blue-500"></i> Analyse Patrimoine (DFLGEST)</span>
                                    <button class="text-gray-400 hover:text-blue-600 transition-colors" title="Ouvrir dossier rapports"><i class="fa-solid fa-folder-open"></i></button>
                                </div>
                                
                                <div class="flex flex-col h-full gap-4">
                                    <!-- Filters Row -->
                                    <div class="bg-gray-50 p-3 rounded border border-gray-200 grid grid-cols-2 gap-4">
                                        <!-- Filter Codes -->
                                        <div>
                                            <div class="text-[0.6rem] font-bold text-gray-400 uppercase tracking-wide mb-2">P√©rim√®tre Codes</div>
                                            <label class="flex items-center gap-2 cursor-pointer mb-1 group">
                                                <input type="radio" name="scope_pat" class="accent-blue-600 w-3 h-3" checked> 
                                                <span class="text-xs font-bold text-gray-700 group-hover:text-blue-600 transition-colors">Complet</span>
                                            </label>
                                            <label class="flex items-center gap-2 cursor-pointer group">
                                                <input type="radio" name="scope_pat" class="accent-blue-600 w-3 h-3"> 
                                                <span class="text-xs text-gray-600 group-hover:text-blue-600 transition-colors">Exclure CS / SC</span>
                                            </label>
                                        </div>
                                        <!-- Filter Fluids -->
                                        <div>
                                            <div class="text-[0.6rem] font-bold text-gray-400 uppercase tracking-wide mb-2">Filtre Fluides</div>
                                            <div class="flex flex-col gap-1">
                                                <label class="flex items-center gap-2 cursor-pointer group">
                                                    <input type="checkbox" checked class="accent-blue-600 w-3 h-3 rounded">
                                                    <span class="text-xs text-gray-600 group-hover:text-blue-600 transition-colors">Eau (EF/ECS)</span>
                                                </label>
                                                <label class="flex items-center gap-2 cursor-pointer group">
                                                    <input type="checkbox" checked class="accent-blue-600 w-3 h-3 rounded">
                                                    <span class="text-xs text-gray-600 group-hover:text-blue-600 transition-colors">Chauffage (RFC/CET)</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Actions -->
                                    <div class="grid grid-cols-2 gap-3 mt-auto">
                                        <button class="btn-action bg-blue-600 text-white border-blue-700 justify-center hover:bg-blue-700 shadow-md mb-0 transition-all">
                                            <span class="btn-title text-white">Analyse Globale</span>
                                        </button>
                                        <button class="btn-action bg-white text-gray-600 border-gray-300 justify-center hover:bg-gray-50 mb-0 transition-all">
                                            <span class="btn-title">Sp√©cial Bailleur</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>

                <div id="page-analyse" class="page-content hidden">
                    <h2 class="text-2xl font-light text-gray-800 mb-6">Outils <b class="text-blue-600 font-semibold">EDI</b></h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="card">
                            <div class="card-header">Correctifs Fichiers</div>
                            <div class="btn-action btn-secondary"><i class="fa-solid fa-list-ol text-gray-500 text-lg"></i><span class="btn-title">Codes IF</span></div>
                            <div class="btn-action btn-secondary"><i class="fa-solid fa-eraser text-red-400 text-lg"></i><span class="btn-title">Suppr. RFC 999</span></div>
                            <div class="btn-action btn-secondary"><i class="fa-solid fa-file-code text-blue-400 text-lg"></i><span class="btn-title">EDI CET 8 Car.</span></div>
                        </div>
                    </div>
                </div>

                <div id="page-rapports" class="page-content hidden">
                    <h2 class="text-2xl font-light text-gray-800 mb-6">Rapports & <b class="text-blue-600 font-semibold">Audits</b></h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="card">
                            <div class="card-header">Exports</div>
                            <div class="btn-action"><i class="fa-solid fa-file-excel text-emerald-600 text-lg"></i><span class="btn-title">Export Excel</span></div>
                            <div class="btn-action"><i class="fa-solid fa-file-pdf text-red-600 text-lg"></i><span class="btn-title">Export PDF</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">Audits M√©tier</div>
                            <div class="btn-action"><i class="fa-solid fa-building-user text-blue-600 text-lg"></i><span class="btn-title">Audit Agence</span></div>
                            <div class="btn-action"><i class="fa-solid fa-signature text-purple-600 text-lg"></i><span class="btn-title">√âtat de Pose</span></div>
                            <div class="btn-action"><i class="fa-solid fa-file-invoice text-gray-600 text-lg"></i><span class="btn-title">BPRS Bailleur</span></div>
                        </div>
                    </div>
                </div>

                <div id="page-outils" class="page-content hidden">
                    <h2 class="text-2xl font-light text-gray-800 mb-6">Param√®tres <b class="text-blue-600 font-semibold">Syst√®me</b></h2>
                    <div class="grid grid-cols-2 gap-5">
                        
                        <!-- SELECTION PROFIL (NEW) -->
                        <div class="card">
                            <div class="card-header">Profil Utilisateur</div>
                            <div class="p-2 bg-blue-50 rounded border border-blue-100 mb-3">
                                <label class="text-[0.65rem] font-bold text-blue-500 uppercase block mb-1">S√©lectionner un compte</label>
                                <select id="user-select" class="select-excel">
                                    <option value="aurelien" selected>Aur√©lien DA COSTA</option>
                                    <option value="christopher">Christopher DOS SANTOS</option>
                                    <option value="pauline">Pauline BOUCARD</option>
                                </select>
                            </div>
                            <div class="text-[0.7rem] text-gray-400 italic px-1">
                                <i class="fa-solid fa-info-circle"></i> Le choix du profil charge automatiquement vos chemins r√©seaux et pr√©f√©rences.
                            </div>
                        </div>

                        <!-- CHEMINS (DYNAMIQUE) -->
                        <div class="card">
                            <div class="card-header">Chemins R√©seau</div>
                            
                            <!-- Volume Serveur (RO + Admin Toggle) -->
                            <div class="p-3 bg-gray-50 border border-gray-200 rounded mb-2">
                                <div class="flex items-center justify-between">
                                    <div class="flex-grow">
                                        <label class="text-[0.65rem] font-bold text-gray-400 uppercase flex items-center gap-1 mb-1">
                                            <i class="fa-solid fa-server"></i> Volume Serveur (Syst√®me)
                                        </label>
                                        <div id="path-server-text" class="text-xs font-mono text-blue-600 font-bold">\\jetform_comptage\prod</div>
                                    </div>
                                    
                                    <!-- Lock icon for normal users -->
                                    <i id="server-lock-icon" class="fa-solid fa-lock text-gray-300 hidden"></i>
                                    
                                    <!-- Switch for Admins -->
                                    <div id="server-mode-switch" class="flex bg-white border border-gray-300 rounded overflow-hidden shadow-sm">
                                        <button onclick="setServerMode('prod')" id="btn-mode-prod" class="px-2 py-1 text-[0.6rem] font-bold bg-blue-100 text-blue-700 transition-colors">PROD</button>
                                        <button onclick="setServerMode('sandbox')" id="btn-mode-sandbox" class="px-2 py-1 text-[0.6rem] font-bold text-gray-500 hover:bg-gray-50 transition-colors">RECETTE</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Dossier Source (RW) -->
                            <div class="p-3 bg-white border border-gray-200 rounded mb-2">
                                <div class="flex justify-between items-center mb-1">
                                    <label class="text-[0.65rem] font-bold text-gray-500 uppercase flex items-center gap-1">
                                        <i class="fa-solid fa-folder-open"></i> Dossier Source (Editable)
                                    </label>
                                </div>
                                <div class="flex gap-2">
                                    <input type="text" id="path-source-input" class="input-excel text-xs text-gray-600" value="G:\Mon Drive\Extractions">
                                    <button onclick="savePath()" class="bg-white border border-green-200 text-green-600 hover:bg-green-50 px-3 rounded text-xs font-bold transition-colors">
                                        <i class="fa-solid fa-floppy-disk"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ADMIN -->
                        <div class="card border-red-200 bg-red-50">
                            <div class="card-header text-red-600">ADMINISTRATEUR</div>
                            <div class="btn-action btn-danger h-20 justify-center"><i class="fa-solid fa-key text-xl"></i><span class="btn-title ml-3 text-lg">Service Mode (Sync)</span></div>
                            <div class="grid grid-cols-2 gap-3 mt-3">
                                <div class="btn-action border-red-200 text-red-600 justify-center hover:bg-red-100"><span class="btn-title text-xs">SYNCRO LIEUX</span></div>
                                <div class="btn-action border-red-200 text-red-600 justify-center hover:bg-red-100"><span class="btn-title text-xs">SYNCRO PDM</span></div>
                            </div>
                        </div>
                        <!-- TABLES -->
                        <div class="card">
                            <div class="card-header">Tables de R√©f√©rence</div>
                            <div class="btn-action btn-secondary"><i class="fa-solid fa-users text-gray-500 text-lg"></i><span class="btn-title">Utilisateurs</span></div>
                            <div class="btn-action btn-secondary"><i class="fa-solid fa-building text-gray-500 text-lg"></i><span class="btn-title">Agences</span></div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- STATUS BAR -->
            <div class="status-bar">
                <div class="flex gap-6">
                    <span class="flex items-center gap-2"><i class="fa-solid fa-server text-blue-600"></i> <span class="font-bold text-gray-500 text-[0.65rem] uppercase tracking-wide">Jetform :</span> <span class="text-gray-600">\\jetform_comptage\prod</span></span>
                    <span class="flex items-center gap-2"><i class="fa-solid fa-folder text-yellow-600"></i> <span class="font-bold text-gray-500 text-[0.65rem] uppercase tracking-wide">Source :</span> <span class="text-gray-600">G:\Mon Drive\Extractions</span></span>
                </div>
                <div class="text-green-600 font-bold flex items-center gap-1"><div class="w-1.5 h-1.5 rounded-full bg-green-500"></div> PR√äT</div>
            </div>
        </div>
    </div>

    <script>
        function switchPage(pageId, element) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
            
            // Show target with safety check
            const targetPage = document.getElementById('page-' + pageId);
            if (targetPage) {
                targetPage.classList.remove('hidden');
            } else {
                console.warn("Page introuvable : page-" + pageId);
            }
            
            // Update menu
            if (element) {
                document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
                element.classList.add('active');
            }
        }

        // --- GESTION PROFIL UTILISATEUR (JS SIMULATION POUR VBA) ---
        const users = {
            'aurelien': {
                firstName: 'Aur√©lien',
                initial: 'D.',
                status: 'Administrateur',
                roleClass: 'status-admin',
                isAdmin: true,
                serverPath: '\\\\jetform_comptage\\prod',
                sourcePath: 'G:\\Mon Drive\\Extractions'
            },
            'christopher': {
                firstName: 'Christopher',
                initial: 'D.',
                status: 'Administrateur',
                roleClass: 'status-admin',
                isAdmin: true,
                serverPath: '\\\\jetform_comptage\\assist',
                sourcePath: 'G:\\Mon Drive\\Assist\\Data'
            },
            'pauline': {
                firstName: 'Pauline',
                initial: 'B.',
                status: 'Production',
                roleClass: 'status-prod',
                isAdmin: false,
                serverPath: '\\\\jetform_comptage\\etudes',
                sourcePath: 'G:\\Partag√©s\\Pauline\\Imports'
            }
        };

        // Ecouteur d'√©v√©nement sur la liste d√©roulante
        document.getElementById('user-select').addEventListener('change', function(e) {
            const userId = e.target.value;
            const userData = users[userId];

            if(userData) {
                updateUIForUser(userData);
            }
        });

        function updateUIForUser(userData) {
            // Mise √† jour Dashboard (Bonjour + Statut)
            document.getElementById('dashboard-user-name').textContent = userData.firstName + " " + userData.initial;
            
            const badge = document.getElementById('user-status-badge');
            badge.textContent = userData.status;
            badge.className = 'status-badge ' + userData.roleClass;

            // Mise √† jour Chemins (Page Outils)
            document.getElementById('path-server-text').textContent = userData.serverPath;
            document.getElementById('path-source-input').value = userData.sourcePath;

            // GESTION MODE ADMIN (SERVER SWITCH)
            const switchEl = document.getElementById('server-mode-switch');
            const lockIcon = document.getElementById('server-lock-icon');

            if (userData.isAdmin) {
                switchEl.classList.remove('hidden');
                lockIcon.classList.add('hidden');
                // Reset to PROD by default on user switch
                setServerMode('prod');
            } else {
                switchEl.classList.add('hidden');
                lockIcon.classList.remove('hidden');
                // Force PROD visual
                setServerMode('prod');
            }
        }

        // Fonction pour basculer PROD / SANDBOX
        function setServerMode(mode) {
            const pathText = document.getElementById('path-server-text');
            const btnProd = document.getElementById('btn-mode-prod');
            const btnSandbox = document.getElementById('btn-mode-sandbox');

            if (mode === 'prod') {
                // Style Texte
                pathText.textContent = '\\\\jetform_comptage\\prod';
                pathText.classList.remove('text-orange-600');
                pathText.classList.add('text-blue-600');
                
                // Style Boutons
                btnProd.className = "px-2 py-1 text-[0.6rem] font-bold bg-blue-100 text-blue-700 transition-colors";
                btnSandbox.className = "px-2 py-1 text-[0.6rem] font-bold text-gray-500 hover:bg-gray-50 transition-colors";
            } else {
                // Style Texte
                pathText.textContent = '\\\\jetform_comptage\\recette';
                pathText.classList.remove('text-blue-600');
                pathText.classList.add('text-orange-600');
                
                // Style Boutons
                btnProd.className = "px-2 py-1 text-[0.6rem] font-bold text-gray-500 hover:bg-gray-50 transition-colors";
                btnSandbox.className = "px-2 py-1 text-[0.6rem] font-bold bg-orange-100 text-orange-700 transition-colors";
            }
        }

        function savePath() {
            alert("Chemin Source sauvegard√© avec succ√®s pour l'utilisateur s√©lectionn√©.");
        }

        // Init avec Aur√©lien au chargement
        window.onload = function() {
            updateUIForUser(users['aurelien']);
        };
    </script>
</body>
</html>
