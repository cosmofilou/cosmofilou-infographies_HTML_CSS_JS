<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipeline Unifi√© v3 - Interface de Pilotage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --aurora-bg: radial-gradient(ellipse 80% 60% at 50% -20%,rgba(120,119,198,0.3),hsla(0,0%,100%,0));
            --aurora-bg-dark: radial-gradient(ellipse 80% 60% at 50% -20%,rgba(120,119,198,0.15),rgba(255,255,255,0));
        }

        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb {
            background-color: rgba(156, 163, 175, 0.5);
            border-radius: 20px;
            border: 2px solid transparent;
            background-clip: content-box;
        }
        
        .nav-link {
            transition: all 0.2s ease-in-out;
            border-left: 3px solid transparent;
        }
        
        .nav-link.active {
            background-color: #eef2ff;
            color: #4338ca;
            font-weight: 700;
            border-left-color: #4f46e5;
        }
        .dark .nav-link.active {
            background-color: rgba(67, 56, 202, 0.5);
            color: #c7d2fe;
            border-left-color: #818cf8;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in-up {
            opacity: 0; /* Initial state for observer */
        }
        .is-visible {
            animation: fadeInUp 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        .section-card {
            background-color: rgba(255,255,255,0.7);
            border-radius: 0.75rem;
            padding: 2rem;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease-in-out;
            position: relative;
            overflow: hidden;
        }
        .dark .section-card {
            background-color: rgba(30, 41, 59, 0.7);
            border-color: #334155;
        }

        .glass-nav {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .dark .glass-nav {
            background-color: rgba(15, 23, 42, 0.7);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            z-index: 40; opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-overlay.open { opacity: 1; pointer-events: auto; }
        .modal-container {
            transform: scale(0.95);
            background-color: #f8fafc;
            border-radius: 0.75rem;
            box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            padding: 0;
            z-index: 50;
            width: 90%; max-width: 1000px;
            max-height: 90vh;
            opacity: 0;
            transition: all 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
        }
        .dark .modal-container {
             background-color: #1e293b;
             border: 1px solid #475569;
        }
        .modal-overlay.open .modal-container {
            transform: scale(1);
            opacity: 1;
        }
        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        .dark .modal-header {
            border-bottom-color: #334155;
        }
        .modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            flex-grow: 1;
        }
        .modal-close-btn {
            background: #e2e8f0; color: #475569;
            border-radius: 9999px; width: 2rem; height: 2rem;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .dark .modal-close-btn {
            background: #334155; color: #94a3b8;
        }
        .modal-close-btn:hover {
            transform: scale(1.1) rotate(90deg);
            background: #fca5a5; color: #b91c1c;
        }

        /* SVG Interaction Styles */
        .svg-node {
            transition: all 0.2s ease-in-out; cursor: pointer;
        }
        .svg-node:hover .svg-node-shape {
            filter: brightness(1.1); transform: scale(1.05); transform-origin: center;
        }
        .svg-node:hover .svg-node-text { font-weight: 700; }
        .svg-tooltip {
            position: absolute; opacity: 0; pointer-events: none;
            transition: opacity 0.2s ease-in-out;
            padding: 0.75rem; background-color: #1e293b; color: white;
            border-radius: 0.5rem; font-size: 0.875rem; line-height: 1.25rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            max-width: 250px; z-index: 60;
        }
        .dark .svg-tooltip {
            background-color: #f8fafc; color: #1e293b;
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-700 dark:text-slate-300 transition-colors duration-300">
    <!-- Background Effects -->
    <div class="dark:hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-image: var(--aurora-bg);"></div>
    <div class="hidden dark:block" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-image: var(--aurora-bg-dark);"></div>

    <!-- Left Navigation -->
    <nav class="fixed top-0 left-0 h-full w-64 glass-nav border-r border-slate-200 dark:border-slate-700 p-4 z-20 hidden lg:flex flex-col">
        <div class="flex items-center gap-3 mb-10 p-2">
            <div class="p-2 bg-indigo-600 rounded-lg shrink-0 shadow-lg shadow-indigo-500/20 flex items-center justify-center h-10 w-10">
                <span class="text-2xl">üó∫Ô∏è</span>
            </div>
            <div>
                <h1 class="text-base font-bold text-slate-900 dark:text-white">Guide de D√©ploiement</h1>
                <p class="text-xs text-slate-500 dark:text-slate-400">Pipeline Unifi√© v3</p>
            </div>
        </div>
        <ul id="nav-menu" class="space-y-1.5 overflow-y-auto">
             <li><a href="#flux-visuel" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">‚ö°Ô∏è</span>Flux Visuel</a></li>
             <li class="px-4 pt-4 pb-2 text-xs font-semibold uppercase text-slate-400 dark:text-slate-500">Pr√©sentation</li>
             <li><a href="#hub" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üè†</span>Hub Projet</a></li>
             <li><a href="#portail-agences" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üè¢</span>Portail Agences</a></li>
             <li class="px-4 pt-4 pb-2 text-xs font-semibold uppercase text-slate-400 dark:text-slate-500">Guides de Construction</li>
             <li><a href="#build-hub" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üè†</span>Page Hub Projet</a></li>
             <li><a href="#build-portail" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üè¢</span>Page Portail Agences</a></li>
             <li><a href="#build-pipeline" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üóÉÔ∏è</span>BDD Pipeline Global</a></li>
             <li><a href="#build-connaissances" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üìö</span>BDD Connaissances</a></li>
             <li class="px-4 pt-4 pb-2 text-xs font-semibold uppercase text-slate-400 dark:text-slate-500">Sp√©cifications</li>
             <li><a href="#taxonomie" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üè∑Ô∏è</span>Taxonomie</a></li>
             <li><a href="#priorisation" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üöÄ</span>Priorisation</a></li>
             <li><a href="#templates" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üìã</span>Templates</a></li>
             <li><a href="#qualite-automatisation" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">ü§ñ</span>Automatisation</a></li>
             <li><a href="#vues-op" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üìä</span>Vues de Pilotage</a></li>
             <li><a href="#migration-statuts" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üîÑ</span>Migration</a></li>
             <li><a href="#mise-en-place" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50"><span class="w-5 text-center">üõ†Ô∏è</span>D√©ploiement</a></li>
        </ul>
        <div class="mt-auto p-2">
            <button id="theme-toggle" class="w-full flex items-center justify-center gap-3 px-4 py-2 rounded-lg font-medium bg-slate-100/50 dark:bg-slate-700/50 text-slate-700 dark:text-slate-200 hover:bg-slate-200/50 dark:hover:bg-slate-600/50 transition-all">
                <span id="theme-toggle-dark-icon" class="hidden text-lg">üåô</span>
                <span id="theme-toggle-light-icon" class="hidden text-lg">‚òÄÔ∏è</span>
                <span id="theme-toggle-text"></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="lg:ml-64 p-6 md:p-12">
        <header class="mb-16 text-center lg:text-left fade-in-up is-visible">
            <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 dark:text-white mb-3">
                <span class="bg-gradient-to-r from-indigo-500 via-purple-500 to-sky-400 bg-clip-text text-transparent">Le Guide Ultime du Pipeline Unifi√©</span>
            </h1>
            <p class="text-lg text-slate-500 dark:text-slate-400 max-w-3xl mx-auto lg:mx-0">Ce document est votre plan directeur pour fusionner les suivis de projets Licorne, Hydroplan et GAP en un syst√®me de pilotage centralis√©, puissant et d√©cisionnel sur Notion.</p>
        </header>

        <div id="svg-tooltip" class="svg-tooltip"></div>

        <!-- Section: Visual Workflow -->
        <section id="flux-visuel" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
                <span class="text-3xl">‚ö°Ô∏è</span> Le Flux de Traitement Visuel
            </h2>
            <div class="section-card">
                 <p class="mb-6 text-slate-600 dark:text-slate-300 text-center">Survolez un n≈ìud pour obtenir des d√©tails. Cliquez pour naviguer vers la section correspondante.</p>
                 <svg viewBox="0 0 1100 200" class="w-full">
                    <!-- Lines -->
                    <path d="M 150 100 L 290 100" stroke="#94a3b8" stroke-width="2" stroke-dasharray="5,5"/>
                    <path d="M 450 100 L 590 100" stroke="#94a3b8" stroke-width="2" stroke-dasharray="5,5"/>
                    <path d="M 750 100 L 890 100" stroke="#94a3b8" stroke-width="2" stroke-dasharray="5,5"/>
                    <!-- Nodes -->
                    <g class="svg-node" data-tooltip="Nouvelles demandes entrantes, √† qualifier rapidement." onclick="document.getElementById('vues-op').scrollIntoView({behavior: 'smooth'});">
                        <circle class="svg-node-shape" cx="100" cy="100" r="50" fill="#fecaca" fill-opacity="0.8"/>
                        <text class="svg-node-text" x="100" y="105" text-anchor="middle" fill="#991b1b" font-size="16" font-weight="600">√Ä Trier</text>
                    </g>
                    <g class="svg-node" data-tooltip="Investigation fonctionnelle approfondie par l'√©quipe MOA." onclick="document.getElementById('priorisation').scrollIntoView({behavior: 'smooth'});">
                        <rect class="svg-node-shape" x="300" y="60" width="140" height="80" rx="10" fill="#c7d2fe" fill-opacity="0.8"/>
                        <text class="svg-node-text" x="370" y="105" text-anchor="middle" fill="#3730a3" font-size="16" font-weight="600">Analyse MOA</text>
                    </g>
                    <g class="svg-node" data-tooltip="D√©veloppement de la fonctionnalit√© par l'√©quipe technique." onclick="document.getElementById('priorisation').scrollIntoView({behavior: 'smooth'});">
                        <rect class="svg-node-shape" x="600" y="60" width="140" height="80" rx="10" fill="#bae6fd" fill-opacity="0.8"/>
                        <text class="svg-node-text" x="670" y="105" text-anchor="middle" fill="#0369a1" font-size="16" font-weight="600">D√©veloppement</text>
                    </g>
                    <g class="svg-node" data-tooltip="V√©rification de la conformit√© par la MOA avant le d√©ploiement." onclick="document.getElementById('vues-op').scrollIntoView({behavior: 'smooth'});">
                        <polygon class="svg-node-shape" points="950,50 1050,100 950,150" fill="#fef08a" fill-opacity="0.8"/>
                        <text class="svg-node-text" x="985" y="105" text-anchor="middle" fill="#854d0e" font-size="16" font-weight="600">Recette</text>
                    </g>
                 </svg>
            </div>
        </section>

        <!-- Section: Hub Projet -->
        <section id="hub" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
                Pr√©sentation : üè† Hub Projet
            </h2>
            <div class="section-card">
                <p class="mb-6">Cette page remplacera les diff√©rents accueils existants. Elle doit √™tre simple, orient√©e action et fournir une vue d'ensemble imm√©diate.</p>
                <div class="p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg mb-8">
                    <h4 class="font-bold text-indigo-800 dark:text-indigo-200 mb-2">Message d'Accueil √† Int√©grer :</h4>
                    <div class="text-sm space-y-2 text-slate-600 dark:text-slate-300">
                        <p><strong>Bienvenue sur le Hub de suivi du projet Licorne !</strong></p>
                        <p>Ce projet, supervis√© par la Direction Technique, vise √† unifier et am√©liorer l'efficacit√© de nos op√©rations. Cet espace centralise toutes les demandes, qu'il s'agisse de bugs, d'√©volutions (Stories) ou de rattrapage des anciens syst√®mes (GAP).</p>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h4 class="font-semibold text-lg mb-4">Tableau de Bord d'Actions</h4>
                        <div class="space-y-3">
                            <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">üîò Bouton : <code class="font-semibold">üêû D√©clarer un Bug</code></p>
                            <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">üîò Bouton : <code class="font-semibold">‚ú® Proposer une Story</code></p>
                            <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">üîò Bouton : <code class="font-semibold">üîå Identifier un GAP</code></p>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-semibold text-lg mb-4">Vues Cl√©s</h4>
                         <div class="space-y-3">
                            <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">‚û°Ô∏è Vue li√©e : <code class="font-semibold">Mes Demandes en Cours</code></p>
                            <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">‚û°Ô∏è Vue li√©e : <code class="font-semibold">Recettes en Attente</code></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Portail Agences -->
        <section id="portail-agences" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
               Pr√©sentation : üè¢ Portail Agences
            </h2>
            <div class="section-card">
                 <p class="mb-6">Pour faciliter l'adoption et garantir la qualit√© des donn√©es, il est essentiel de fournir aux agences un point d'entr√©e unique et ultra-simplifi√©.</p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="p-4 bg-slate-100 dark:bg-slate-800/50 rounded-lg">
                       <h5 class="font-bold text-slate-800 dark:text-slate-200">Prox-Hydro</h5>
                       <div class="flex flex-wrap gap-4 mt-3">
                           <div class="p-3 bg-white dark:bg-slate-700 rounded-lg shadow-sm flex-1 min-w-[200px]"><p class="font-semibold">üîò Bouton : <code class="text-red-600 dark:text-red-400">üêû Signaler un Bug</code></p></div>
                            <div class="p-3 bg-white dark:bg-slate-700 rounded-lg shadow-sm flex-1 min-w-[200px]"><p class="font-semibold">üîò Bouton : <code class="text-blue-600 dark:text-blue-400">‚ú® √âvolution</code></p></div>
                       </div>
                    </div>
                    <div class="p-4 bg-slate-100 dark:bg-slate-800/50 rounded-lg">
                       <h5 class="font-bold text-slate-800 dark:text-slate-200">Agence PXS Est</h5>
                       <div class="flex flex-wrap gap-4 mt-3">
                           <div class="p-3 bg-white dark:bg-slate-700 rounded-lg shadow-sm flex-1 min-w-[200px]"><p class="font-semibold">üîò Bouton : <code class="text-red-600 dark:text-red-400">üêû Signaler un Bug</code></p></div>
                           <div class="p-3 bg-white dark:bg-slate-700 rounded-lg shadow-sm flex-1 min-w-[200px]"><p class="font-semibold">üîò Bouton : <code class="text-blue-600 dark:text-blue-400">‚ú® √âvolution</code></p></div>
                       </div>
                    </div>
                 </div>
            </div>
        </section>

        <!-- NOUVELLE SECTION: GUIDE HUB -->
        <section id="build-hub" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
                Guide de Construction : üè† Hub Projet
            </h2>
            <div class="section-card">
                <blockquote class="border-l-4 border-indigo-500 pl-4 mb-6 text-slate-600 dark:text-slate-300">
                    <p class="font-bold">Objectif de la page :</p>
                    <p>Fournir √† l'√©quipe MOA une tour de contr√¥le pour organiser sa journ√©e. La page doit permettre de voir en un clin d'≈ìil les priorit√©s, les blocages et la sant√© du projet.</p>
                </blockquote>
                 <div class="p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg mb-8">
                    <h4 class="font-bold text-indigo-800 dark:text-indigo-200 mb-2">Message de bienvenue √† int√©grer :</h4>
                    <div class="text-sm text-slate-600 dark:text-slate-300">
                        "Bienvenue sur la tour de contr√¥le du projet. Cet espace a √©t√© con√ßu pour vous, l'√©quipe MOA, afin de vous offrir une vision claire et actionnable de l'ensemble des activit√©s. Chaque matin, commencez votre journ√©e ici pour identifier vos priorit√©s. Contact en cas de probl√®me : Aur√©lien DA COSTA."
                    </div>
                </div>
                <div class="grid lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-1 space-y-4">
                        <h4 class="font-semibold text-lg">Colonne 1 : Indicateurs Cl√©s</h4>
                        <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">üî¢ Indicateur : <strong>Tickets √† Trier</strong><br><span class="text-xs"> (Vue "Nombre" filtr√©e sur Statut = "√Ä trier")</span></p>
                        <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">üî¢ Indicateur : <strong>Bugs Ouverts Urgents</strong><br><span class="text-xs">(Vue "Nombre" filtr√©e sur Type = "Bug" ET Priorit√© = "Haute")</span></p>
                    </div>
                     <div class="lg:col-span-1 space-y-4">
                        <h4 class="font-semibold text-lg">Colonne 2 : Mes Actions</h4>
                        <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">‚û°Ô∏è Vue Li√©e : <strong>üî• Mon Triage</strong><br><span class="text-xs">(Filtre : Statut = "√Ä trier" ET Responsable = "Moi")</span></p>
                        <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">‚û°Ô∏è Vue Li√©e : <strong>üöß Mes Blocages</strong><br><span class="text-xs">(Filtre : Statut = "Bloqu√©" ET Responsable = "Moi")</span></p>
                    </div>
                     <div class="lg:col-span-1 space-y-4">
                        <h4 class="font-semibold text-lg">Colonne 3 : Raccourcis</h4>
                        <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">üîò Bouton Notion : <strong>üêû D√©clarer un Bug</strong><br><span class="text-xs">(Action : Cr√©er page avec template "BUG")</span></p>
                        <p class="p-3 bg-slate-100 dark:bg-slate-800 rounded-lg">üîò Bouton Notion : <strong>‚ú® Proposer une Story</strong><br><span class="text-xs">(Action : Cr√©er page avec template "STORY")</span></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- NOUVELLE SECTION: GUIDE PORTAIL -->
        <section id="build-portail" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
                Guide de Construction : üè¢ Portail Agences
            </h2>
            <div class="section-card">
                 <blockquote class="border-l-4 border-yellow-500 pl-4 mb-6 text-slate-600 dark:text-slate-300">
                    <p class="font-bold">Objectif de la page :</p>
                    <p>Simplifier radicalement la cr√©ation de tickets pour les utilisateurs. Z√©ro friction, z√©ro question √† se poser. L'utilisateur clique sur son p√©rim√®tre, son besoin, et remplit le formulaire.</p>
                </blockquote>
                <div class="p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg mb-8">
                    <h4 class="font-bold text-yellow-800 dark:text-yellow-200 mb-2">Message de bienvenue √† int√©grer :</h4>
                    <div class="text-sm text-slate-600 dark:text-slate-300">
                        "Une id√©e d'am√©lioration ? Un bug √† nous remonter ? Vous √™tes au bon endroit ! Cet espace a √©t√© sp√©cialement con√ßu pour vous permettre de soumettre vos demandes simplement et efficacement. Choisissez votre p√©rim√®tre ci-dessous et utilisez les boutons pour cr√©er votre demande. Le bon formulaire s'ouvrira et les informations de base seront pr√©-remplies. Contact : Aur√©lien DA COSTA."
                    </div>
                </div>
                 <h4 class="font-semibold text-lg mb-4">Structure de la Page</h4>
                 <p class="mb-4 text-sm">La page doit √™tre une succession de sections, une pour chaque `P√©rim√®tre`. Chaque section contiendra deux boutons Notion.</p>
                 <div class="p-4 bg-slate-100 dark:bg-slate-800/50 rounded-lg">
                    <h5 class="font-bold text-slate-800 dark:text-slate-200">Exemple pour le p√©rim√®tre "Prox-Hydro"</h5>
                    <div class="flex flex-wrap gap-4 mt-3">
                        <div class="p-3 bg-white dark:bg-slate-700 rounded-lg shadow-sm flex-1">
                           <p class="font-semibold">üîò Bouton 1 : "üêû Signaler un Bug sur Prox-Hydro"</p>
                           <ul class="text-xs list-disc list-inside mt-1 text-slate-500 dark:text-slate-400">
                               <li>Action : Cr√©er une page dans `Pipeline Global`</li>
                               <li>Template √† appliquer : `[BUG] -`</li>
                               <li>Propri√©t√© √† pr√©-remplir : `P√©rim√®tre` = `Prox-Hydro`</li>
                           </ul>
                       </div>
                       <div class="p-3 bg-white dark:bg-slate-700 rounded-lg shadow-sm flex-1">
                           <p class="font-semibold">üîò Bouton 2 : "‚ú® Proposer une √âvolution pour Prox-Hydro"</p>
                           <ul class="text-xs list-disc list-inside mt-1 text-slate-500 dark:text-slate-400">
                               <li>Action : Cr√©er une page dans `Pipeline Global`</li>
                               <li>Template √† appliquer : `[STORY] -`</li>
                               <li>Propri√©t√© √† pr√©-remplir : `P√©rim√®tre` = `Prox-Hydro`</li>
                           </ul>
                       </div>
                    </div>
                    <p class="text-xs italic mt-4 text-slate-500 dark:text-slate-400">R√©p√©ter cette structure pour tous les autres p√©rim√®tres (Agence PXS Est, IDF, etc.).</p>
                 </div>
            </div>
        </section>
        
        <!-- NOUVELLE SECTION: GUIDE PIPELINE -->
        <section id="build-pipeline" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
                Guide de Construction : üóÉÔ∏è BDD Pipeline Global
            </h2>
             <div class="section-card">
                 <blockquote class="border-l-4 border-green-500 pl-4 mb-6 text-slate-600 dark:text-slate-300">
                    <p class="font-bold">Objectif de la page :</p>
                    <p>Cr√©er une page d√©di√©e pour visualiser et interagir avec la base de donn√©es `Pipeline Global` sous diff√©rents angles, afin de r√©pondre √† des besoins d'analyse vari√©s.</p>
                </blockquote>
                 <p class="mb-6 text-sm">Cr√©ez une nouvelle page `Pipeline Global des Demandes`. Sur cette page, ins√©rez une vue li√©e de la base de donn√©es du m√™me nom, et configurez les onglets de vue suivants :</p>
                 <div class="space-y-4">
                    <div class="p-4 bg-slate-100 dark:bg-slate-800 rounded-lg"><strong>‚û°Ô∏è Onglet 1 : "Tableau Complet" (par d√©faut)</strong><br><span class="text-xs"> (Type : Tableau. Aucuns filtres. Pour une vue brute de toutes les donn√©es.)</span></div>
                    <div class="p-4 bg-slate-100 dark:bg-slate-800 rounded-lg"><strong>‚û°Ô∏è Onglet 2 : "Kanban par Statut"</strong><br><span class="text-xs"> (Type : Tableau Kanban. Group√© par la propri√©t√© `Statut`. Pour le suivi du flux de travail.)</span></div>
                    <div class="p-4 bg-slate-100 dark:bg-slate-800 rounded-lg"><strong>‚û°Ô∏è Onglet 3 : "Calendrier des R√©solutions"</strong><br><span class="text-xs"> (Type : Calendrier. Bas√© sur la propri√©t√© `Date de r√©solution`. Pour visualiser les livraisons.)</span></div>
                 </div>
            </div>
        </section>

        <!-- NOUVELLE SECTION: GUIDE CONNAISSANCES -->
        <section id="build-connaissances" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
                Guide de Construction : üìö BDD Base de Connaissances
            </h2>
             <div class="section-card">
                <blockquote class="border-l-4 border-purple-500 pl-4 mb-6 text-slate-600 dark:text-slate-300">
                    <p class="font-bold">Objectif de la page :</p>
                    <p>Centraliser toute la documentation du projet (sp√©cifications, guides, d√©cisions) dans un format facile √† naviguer et √† consulter, √† la mani√®re d'un Wiki interne.</p>
                </blockquote>
                <p class="mb-6 text-sm">Cr√©ez une nouvelle page `Base de Connaissances`. Sur cette page, ins√©rez une vue li√©e de la base de donn√©es du m√™me nom.</p>
                <div class="p-4 bg-slate-100 dark:bg-slate-800 rounded-lg">
                    <h4 class="font-semibold">Vue Recommand√©e : "Galerie par Type d'Article"</h4>
                    <ul class="text-sm list-disc list-inside mt-2 text-slate-600 dark:text-slate-400">
                        <li><strong>Type de vue :</strong> Galerie</li>
                        <li><strong>Group√© par :</strong> `Type d'Article`</li>
                        <li><strong>Aper√ßu de la carte :</strong> Contenu de la page</li>
                        <li><strong>Taille de la carte :</strong> Moyenne</li>
                    </ul>
                    <p class="text-xs italic mt-2">Cette vue permet de s√©parer visuellement les sp√©cifications, des guides, des comptes-rendus, rendant la navigation tr√®s intuitive.</p>
                </div>
            </div>
        </section>

        <!-- Section: Taxonomie (NOW A MODAL) -->
        <section id="taxonomie" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">
                üè∑Ô∏è La Base de Donn√©es : Taxonomie Unifi√©e
            </h2>
            <div class="section-card text-center">
                 <p class="mb-6 text-slate-600 dark:text-slate-300">Le c≈ìur du syst√®me. Une base de donn√©es unique avec une structure de propri√©t√©s solide. Pour all√©ger l'interface, les sp√©cifications techniques d√©taill√©es sont accessibles via le bouton ci-dessous.</p>
                 <button onclick="openModal('modal-taxonomie')" class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-lg hover:bg-indigo-700 transition-transform transform hover:scale-105">
                    Ouvrir les Sp√©cifications D√©taill√©es
                 </button>
            </div>
        </section>
        
        <!-- Section: Priorisation & Sprints -->
        <section id="priorisation" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">üöÄ Priorisation & Sprints</h2>
            <div class="section-card">
                <div class="mb-6 p-4 bg-indigo-50 dark:bg-indigo-900/20 border-l-4 border-indigo-500 rounded-r-lg">
                    <h4 class="font-bold text-indigo-800 dark:text-indigo-200">Devenir D√©cisionnel : Le Guide de la Priorisation</h4>
                    <p class="text-sm mt-1">Pour piloter efficacement, il faut pouvoir passer d'une simple liste de t√¢ches √† une roadmap strat√©gique. Cela passe par la m√©thode RICE (Reach, Impact, Confidence, Effort).</p>
                </div>
                <h4 class="text-lg font-semibold mb-4">La Formule Magique dans Notion</h4>
                <div class="p-4 bg-slate-100 dark:bg-slate-700 rounded-lg mt-4 font-mono text-sm">
                    <code>if(prop("Effort") > 0, round(prop("Impact") * (prop("Confiance") / 100) / prop("Effort") * 100) / 100, 0)</code>
                </div>
            </div>
        </section>

        <!-- Section: Templates -->
        <section id="templates" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">üìã Templates d'Action</h2>
            <div class="space-y-8">
                <div class="section-card">
                    <h3 class="text-2xl font-bold mb-2 text-slate-800 dark:text-slate-100">üîß Template : Support & Correction</h3>
                    <div class="space-y-4 text-sm mt-4">
                        <div class="border-l-4 border-slate-400 bg-slate-50 dark:bg-slate-800/50 p-4 rounded-r-lg">
                            <h4 class="font-bold text-slate-800 dark:text-slate-200">üìù R√©sum√© du Probl√®me / Question</h4>
                        </div>
                        <div class="border-l-4 border-red-500 bg-red-50 dark:bg-red-900/20 p-4 rounded-r-lg">
                            <h4 class="font-bold text-red-800 dark:text-red-300">‚ñ∂Ô∏è Analyse du Bug</h4>
                        </div>
                         <div class="border-l-4 border-slate-400 bg-slate-50 dark:bg-slate-800/50 p-4 rounded-r-lg">
                            <h4 class="font-bold text-slate-800 dark:text-slate-200">üìé Pi√®ces Jointes</h4>
                        </div>
                    </div>
                </div>
                <div class="section-card">
                    <h3 class="text-2xl font-bold mb-2 text-slate-800 dark:text-slate-100">‚ú® Template : Story & GAP</h3>
                    <div class="space-y-4 text-sm mt-4">
                        <div class="border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-r-lg">
                            <h4 class="font-bold text-blue-800 dark:text-blue-300">1. Le "Pourquoi" (Besoin m√©tier)</h4>
                        </div>
                         <div class="border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-r-lg">
                            <h4 class="font-bold text-blue-800 dark:text-blue-300">2. Le "Quoi" (Cible fonctionnelle)</h4>
                        </div>
                        <div class="border-l-4 border-green-500 bg-green-50 dark:bg-green-900/20 p-4 rounded-r-lg">
                            <h4 class="font-bold text-green-800 dark:text-green-300">4. R√©daction du Ticket Jira</h4>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Qualit√© & Automatisation -->
        <section id="qualite-automatisation" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">ü§ñ Qualit√© & Automatisation par Boutons</h2>
            <div class="section-card">
                <h3 class="text-xl font-bold mb-6 text-slate-800 dark:text-slate-100">Boutons d'Action Pertinents</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg ring-1 ring-slate-200 dark:ring-slate-700">
                        <h4 class="font-bold text-lg mb-2">‚úÖ Terminer le Ticket</h4>
                    </div>
                    <div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg ring-1 ring-slate-200 dark:ring-slate-700">
                        <h4 class="font-bold text-lg mb-2">üì° Escalader √† la DSI</h4>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Vues de Pilotage -->
        <section id="vues-op" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">üìä Vues de Pilotage</h2>
            <div class="section-card">
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-md ring-1 ring-slate-200 dark:ring-slate-700">
                        <h3 class="text-lg font-bold mb-2">üî• Mon Triage MOA</h3>
                    </div>
                    <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-md ring-1 ring-slate-200 dark:ring-slate-700">
                        <h3 class="text-lg font-bold mb-2">ü©∫ Sant√© des Applications</h3>
                    </div>
                    <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-md ring-1 ring-slate-200 dark:ring-slate-700">
                        <h3 class="text-lg font-bold mb-2">üîå Suivi des GAPs</h3>
                    </div>
                    <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-md ring-1 ring-slate-200 dark:ring-slate-700">
                        <h3 class="text-lg font-bold mb-2">‚è±Ô∏è Analyse des D√©lais</h3>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Section: Migration -->
        <section id="migration-statuts" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">üîÑ Migration des Statuts</h2>
             <div class="section-card overflow-x-auto">
                <h3 class="text-xl font-bold mb-4 text-slate-800 dark:text-slate-100">Guide de Correspondance des Statuts</h3>
                <table class="w-full text-sm text-left">
                    <thead class="text-xs text-slate-700 uppercase bg-slate-100/50 dark:bg-slate-800/50 dark:text-slate-300">
                        <tr>
                            <th class="p-3">Ancien Statut</th><th class="p-3">Outil d'Origine</th><th class="p-3">Nouveau Statut Cible</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-600 dark:text-slate-300">
                        <tr class="border-t dark:border-slate-700"><td class="p-3">Nouveau</td><td class="p-3">Licorne</td><td class="p-3 font-semibold text-red-600 dark:text-red-400">0. √Ä Trier üî¥</td></tr>
                        <tr class="border-t dark:border-slate-700"><td class="p-3">En cours d'analyse</td><td class="p-3">GAP</td><td class="p-3 font-semibold text-blue-600 dark:text-blue-400">1. En analyse MOA üîµ</td></tr>
                        <tr class="border-t dark:border-slate-700"><td class="p-3">R√©solu / Termin√©</td><td class="p-3">Tous</td><td class="p-3 font-semibold text-green-600 dark:text-green-400">5. Termin√© üì¶</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Section: D√©ploiement -->
        <section id="mise-en-place" class="scroll-mt-20 mb-20 fade-in-up">
            <h2 class="text-3xl font-bold mb-8 text-slate-900 dark:text-white flex items-center gap-3">üõ†Ô∏è Plan de D√©ploiement</h2>
            <div class="space-y-6">
                <div class="section-card"><h3 class="text-xl font-bold text-slate-800 dark:text-slate-100">Phase 1 : Construction du Socle</h3></div>
                 <div class="section-card"><h3 class="text-xl font-bold text-slate-800 dark:text-slate-100">Phase 2 : Cr√©ation de l'Espace de Travail</h3></div>
                 <div class="section-card"><h3 class="text-xl font-bold text-slate-800 dark:text-slate-100">Phase 3 : Migration & Formation</h3></div>
                <div class="section-card"><h3 class="text-xl font-bold text-slate-800 dark:text-slate-100">Phase 4 : D√©ploiement Complet</h3></div>
            </div>
        </section>

        <footer class="text-center mt-16 py-8 border-t border-slate-200 dark:border-slate-700 fade-in-up">
            <p class="text-sm text-slate-500 dark:text-slate-400">&copy; 2025 - Con√ßu par cosmofilou & Gemini. Tous droits r√©serv√©s.</p>
        </footer>
    </main>

    <!-- MODAL for Taxonomie -->
    <div id="modal-taxonomie" class="modal-overlay" onclick="closeModal('modal-taxonomie')">
        <div class="modal-container" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div>
                    <h3 class="text-2xl font-bold text-slate-800 dark:text-slate-100">üè∑Ô∏è Taxonomie D√©taill√©e</h3>
                    <p class="text-sm text-slate-500 dark:text-slate-400">Structure compl√®te de la base de donn√©es `Pipeline Global`.</p>
                </div>
                 <button class="modal-close-btn" onclick="closeModal('modal-taxonomie')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="mb-4 sticky top-0 bg-fuchsia-50/80 dark:bg-slate-900/80 backdrop-blur-sm py-2 -mx-6 px-6">
                    <input type="search" id="taxonomie-search" placeholder="Rechercher une propri√©t√© (ex: Statut, RICE, Jira...)" class="w-full px-4 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none">
                </div>
                <div id="taxonomie-content-wrapper" class="space-y-10">
                    <!-- Cat√©gorie: Qualification Initiale -->
                    <div data-searchable-section>
                        <h3 class="text-xl font-semibold mb-4 text-slate-800 dark:text-slate-100 border-b pb-2">Qualification Initiale</h3>
                        <div class="grid md:grid-cols-2 gap-6 mt-4">
                            <div class="bg-white dark:bg-slate-800/50 rounded-xl p-6 shadow-sm ring-1 ring-slate-200 dark:ring-slate-700" data-searchable-item>
                                <h4 class="font-bold text-slate-800 dark:text-slate-100">Type de Demande</h4>
                                <p class="text-xs font-mono mb-3 text-indigo-500">Propri√©t√© `S√©lection`</p>
                                <ul class="space-y-2 text-sm">
                                    <li><code class="bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded">üêû Bug</code></li>
                                    <li><code class="bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded">‚ú® Story</code></li>
                                    <li><code class="bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded">üîå GAP</code></li>
                                </ul>
                            </div>
                            <div class="bg-white dark:bg-slate-800/50 rounded-xl p-6 shadow-sm ring-1 ring-slate-200 dark:ring-slate-700" data-searchable-item>
                                <h4 class="font-bold text-slate-800 dark:text-slate-100">P√©rim√®tre</h4>
                                <p class="text-xs font-mono mb-3 text-indigo-500">Propri√©t√© `S√©lection Multiple`</p>
                                <ul class="space-y-2 text-sm">
                                    <li><code class="bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded">Prox-Hydro</code></li>
                                    <li><code class="bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded">Agence PXS Est</code></li>
                                </ul>
                            </div>
                             <div class="md:col-span-2 bg-white dark:bg-slate-800/50 rounded-xl p-6 shadow-sm ring-1 ring-slate-200 dark:ring-slate-700" data-searchable-item>
                                <h4 class="font-bold text-slate-800 dark:text-slate-100">Domaine Fonctionnel</h4>
                                 <p class="text-xs font-mono mb-3 text-indigo-500">Propri√©t√© `S√©lection Multiple`</p>
                            </div>
                        </div>
                    </div>
                     <!-- Cat√©gorie: Cycle de Vie -->
                    <div data-searchable-section>
                        <h3 class="text-xl font-semibold mb-4 text-slate-800 dark:text-slate-100 border-b pb-2">Cycle de Vie & Suivi</h3>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4">
                             <div class="bg-white dark:bg-slate-800/50 rounded-xl p-6 shadow-sm ring-1 ring-slate-200 dark:ring-slate-700" data-searchable-item>
                                <h4 class="font-bold text-slate-800 dark:text-slate-100">Statut</h4>
                            </div>
                            <div class="bg-white dark:bg-slate-800/50 rounded-xl p-6 shadow-sm ring-1 ring-slate-200 dark:ring-slate-700" data-searchable-item>
                                <h4 class="font-bold text-slate-800 dark:text-slate-100">N¬∞ de Ticket</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Theme Toggle ---
            const themeToggleBtn = document.getElementById('theme-toggle');
            const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
            const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
            const themeToggleText = document.getElementById('theme-toggle-text');

            const updateButtonUI = (isDark) => {
                themeToggleLightIcon.classList.toggle('hidden', !isDark);
                themeToggleDarkIcon.classList.toggle('hidden', isDark);
                themeToggleText.textContent = isDark ? 'Mode Clair' : 'Mode Sombre';
            };

            const applyTheme = (isDark) => {
                document.documentElement.classList.toggle('dark', isDark);
            };
            
            const initialIsDark = localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            applyTheme(initialIsDark);
            updateButtonUI(initialIsDark);

            themeToggleBtn.addEventListener('click', () => {
                const newIsDark = !document.documentElement.classList.contains('dark');
                applyTheme(newIsDark);
                updateButtonUI(newIsDark);
                localStorage.setItem('color-theme', newIsDark ? 'dark' : 'light');
            });

            // --- Active Nav Link on Scroll (Scroll-spy) ---
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link');
            const navMenu = document.getElementById('nav-menu');

            const activateNavLink = (id) => {
                let activeLink = null;
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if(link.getAttribute('href') === `#${id}`) {
                        link.classList.add('active');
                        activeLink = link;
                    }
                });
                 if (activeLink && navMenu) {
                     const navRect = navMenu.getBoundingClientRect();
                     const linkRect = activeLink.getBoundingClientRect();
                     if (linkRect.bottom > navRect.bottom || linkRect.top < navRect.top) {
                         activeLink.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                     }
                 }
            };

            const scrollObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        activateNavLink(entry.target.id);
                    }
                });
            }, { rootMargin: '-20% 0px -75% 0px' });
            sections.forEach(section => scrollObserver.observe(section));

            // --- Animation on Scroll ---
            const animatedElements = document.querySelectorAll('.fade-in-up');
            const animationObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            animatedElements.forEach(el => animationObserver.observe(el));

            // --- SVG Interactivity ---
            const tooltip = document.getElementById('svg-tooltip');
            document.querySelectorAll('.svg-node').forEach(node => {
                node.addEventListener('mouseenter', (e) => {
                    tooltip.textContent = node.dataset.tooltip;
                    tooltip.style.opacity = 1;
                });
                node.addEventListener('mousemove', (e) => {
                    tooltip.style.left = `${e.pageX + 15}px`;
                    tooltip.style.top = `${e.pageY + 15}px`;
                });
                node.addEventListener('mouseleave', () => {
                    tooltip.style.opacity = 0;
                });
            });

            // --- Modal Search ---
            const taxonomieSearch = document.getElementById('taxonomie-search');
            if(taxonomieSearch) {
                taxonomieSearch.addEventListener('keyup', () => {
                    const filter = taxonomieSearch.value.toLowerCase();
                    const wrapper = document.getElementById('taxonomie-content-wrapper');
                    const items = wrapper.querySelectorAll('[data-searchable-item]');
                    const sections = wrapper.querySelectorAll('[data-searchable-section]');

                    items.forEach(item => {
                        const text = item.textContent.toLowerCase();
                        item.style.display = text.includes(filter) ? '' : 'none';
                    });
                    
                     sections.forEach(section => {
                        const visibleItems = section.querySelectorAll('[data-searchable-item]:not([style*="display: none"])');
                        section.style.display = visibleItems.length > 0 ? '' : 'none';
                    });
                });
            }
        });

        // --- Modal Controls (Global scope for onclick) ---
        function openModal(modalId) {
            document.getElementById(modalId)?.classList.add('open');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                const container = modal.querySelector('.modal-container');
                if (container) {
                    container.style.transform = 'scale(0.95)';
                    container.style.opacity = '0';
                }
                setTimeout(() => {
                    modal.classList.remove('open');
                    if (container) {
                        container.style.transform = '';
                        container.style.opacity = '';
                    }
                }, 300);
            }
        }
        
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                const openModal = document.querySelector('.modal-overlay.open');
                if (openModal) {
                    closeModal(openModal.id);
                }
            }
        });

    </script>
</body>
</html>

